#!/bin/sh

#./build.sh

#10000000000000000000000000

rm -rf ~/.near-credentials/testnet/dev-*

ACCOUNT=$(near dev-deploy --wasmFile ./target/wasm32-unknown-unknown/release/contract.wasm | sed -n '5,1p' | grep -o -E "dev-\d+-\d+")

echo ">> Deploying contract"

near call $ACCOUNT init '{}' --accountId $ACCOUNT

#Should throw error
near view $ACCOUNT get_balance '{"acc": "timur-dev.testnet"}' -v --accountId $ACCOUNT

near call $ACCOUNT deposit '{"amount": "10000000000000000000000000"}' --accountId timur-dev.testnet --deposit 10

#Should give 10
near view $ACCOUNT get_balance '{"acc": "timur-dev.testnet"}' -v --accountId $ACCOUNT

near call $ACCOUNT withdraw '{"amount": "10000000000000000000000000"}' --accountId timur-dev.testnet

# Should give 0
near view $ACCOUNT get_balance '{"acc": "timur-dev.testnet"}' -v --accountId $ACCOUNT
